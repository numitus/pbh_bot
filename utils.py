import re

from Stemmer import Stemmer
from sklearn.feature_extraction.text import CountVectorizer

from answers import CAN_I_IN_POLAND_GET_VISA, HOW_TO_GO_OUT, EXPIRE_VISA, \
    RECOMENDATION, CAR_IN_POLAND, CARANTIN, BLUE_CARD, IP_CHAT, INCUBATOR, \
    ANKETA, INSURE_FOR_VISA, VISA_FOR_FAMILY, GRUZIA, PESEL, BANKI, \
    DECLARATION, TOURISM, TRANSIT, ANIMALS, HOUSE, APOSTIL

messages = {
    CAN_I_IN_POLAND_GET_VISA: "В настоящее время продлить визу или сделать новую визу в Польше нельзя,"
                              " вы должны выехать за пределы ЕС (самый частый "
                              "вариант это Грузия) и открыть визу там. \n"
                                "!!! ВНИМАНИЕ. СЕЙЧАС ЕСТЬ ВОПРОСЫ С ПОЛУЧЕНИЕМ ВИЗЫ В ГРУЗИИ БЕЗ ВНЖ."
                              " Уточняйте информацию в чате Грузии https://t.me/PBH\_GE2PLN",

    HOW_TO_GO_OUT: "Для выезда из РБ наземным транспортом в Польшу/Литву/Латвию/Украину каждому совершеннолетнему необходимо основание, которое предъявляется сотрудникам пограничной службы РБ. \n"
                   "Это может быть: ВНЖ/разрешение на работу/трудовой договор/договор на лечение/командировка. Факт замужества для второго супруга основанием не является! \n"
                   "Документ должен быть на рус. или бел. языке. Если договор изначально двуязычный (один из которых - рус. или бел.) - достаточно копии (скана) документа. Иначе необходим оригинал документа (с печатью) и нотариально заверенный перевод. \n"
                   "Тип визы не имеет значения для пограничной службы РБ. \n"
                   "Подробнее тут (https://t.me/PBH\_BY2PLN/134086) \n."
                   "Полякам или литовцам основание не надо. \n"
                   "В настоящее время Польша разрешает въезд граждан РБ с любым типом визы.",

    EXPIRE_VISA: "В настоящее время все польские национальные визы (тип D) автоматически продляются до конца пандемии +30 дней. \n"
                 "Обязательное условие: в последний день действия визы вы должны находиться в Польше. \n"
                 "С продленной визой вы можете выехать в РБ и вернуться в Польшу, но не можете въезжать в другие страны ЕС. \n"
                 "С высокой долей вероятности, с такой визой не посадят на самолет/автобус в направлении Польши, поэтому рекомендуем ездить на личном транспорте. \n"
                 "Также вы можете податься на новую визу в консульстве Польши за пределами ЕС, например в Грузии \n"
                 "!!! ВНИМАНИЕ. СЕЙЧАС ЕСТЬ ВОПРОСЫ С ПОЛУЧЕНИЕМ ВИЗЫ В ГРУЗИИ БЕЗ ВНЖ."
                 " Уточняйте информацию в чате Грузии https://t.me/PBH\_GE2PLN \n"
                 "Теги с отчетами о повторной подаче на визу PBH #повторнаяподача #повторная\_подача",

    RECOMENDATION: "Для подачи на визу PBH вам нужна рекомендация от компании-партнера (https://t.me/PBH\_BY2PLN/156967). "
                   "Это может быть даже распечатка email. \n"
                   "Пример рекомендации (https://t.me/PBH\_BY2PLN/170449). Также необходим стаж в 1 год или образование по ИТ специальности. \n"
                   "Помощь в получении рекомендации - @root\_eu, @IT\_Kristi\_Yala",

    CAR_IN_POLAND: "Для вьезда в польшу на автомобиле с регистрацией в РБ необходима зеленая карта, сделанная в РБ (обязательно, независимо от наличия польской страховки), техпаспорт и права."
                   " Зеленую карту достаточно сделать на минимальный срок (15 дней) для выезда, а в Польше вы можете оформить страховку на год. Компания Allianz, OC Graniczne, стоимость 840зл \n"
                   "Поляки не смотрят на техосмотр, а литовцы иногда смотрят и могут развернуть при его отсутствии.\n"
                   "Если авто оформлено не на вас, то необходима доверенность, которая может быть составлена в произвольной форме. \n"
                   "По закону, вы можете находиться на иностранном авто в ЕС максимум полгода в год. Факт выезда за пределы Польши (например в РБ) не влияет на этот срок. \n"
                   "Можно переоформить автомобиль на польские номера без уплаты таможенной пошлины (https://chechannel.com/mienie-przesiedlencze/) \n"
                   "Также вам необходимо поменять права после 185 дней в Польше. (https://t.me/BelarusPoland/1798)",

    CARANTIN: "В настоящее время для выезда в Польшу подходит ПЦР либо антиген тест на англ. либо польском языках (подойдет в электронном виде). \n"
              "При выезде через Литву (транзит в Польшу) тест не требуется.\n "
              "Больше информации о тестах, карантине и о том, как обойти карантин в Польше: https://t.me/PBH\_BY2PLN/112404 \n "
              "Информация о вакцинации в Польше: https://t.me/medicine\_PBH/10435",

    BLUE_CARD: "Больше информации вы можете найти в чате Blue Card https://t.me/Bluecard\_PBH",
    IP_CHAT: "Больше информации вы можете найти в чате ИП в Польше https://t.me/JDG\_PBH",
    INCUBATOR: "Больше информации вы можете найти в чате бизнес-инкубаторов https://t.me/joinchat/p47wWwYdO6llOTBi",

    ANKETA: "Детальная информация о пакете документов для визы PBH:  https://telegra.ph/Paket-dokumentov-dlya-vizy-PBH-03-11 \n"
            "Информация по заполнению анкеты (с примером): https://telegra.ph/Anketa-dlya-vizy-PBH-Primer-zapolneniya-03-03 \n",

    INSURE_FOR_VISA: "Для получения визы вам нужна страховка на каждого члена семьи на весь срок действия визы (365 дней), можно с коридором действия полиса в 2-3 года. Самые бюджетные варианты: Белнефтестрах и Асоба (стоимость 35-40 евро)",

    VISA_FOR_FAMILY: "Если вы имеете основания для визы PBH, то ваши несовершеннолетние дети и супруг(а) также могут рассчитывать на получение визы с пометкой PBH, с доступом к рынку труда (т.е. нет необходимости получать доп. разрешение при устройстве на работу) и правом регистрировать свою деятельность как предприниматель в Польше. \n"
                     "Информация о визе для родителей: #визадляродителей . Ваши девушка/парень могут получить обычную визу D23 без доступа к рынку труда. \n"
                     "Больше деталей: https://telegra.ph/Paket-dokumentov-dlya-vizy-PBH-03-11",

    GRUZIA: "Больше информации вы можете найти в чате PBH для Грузии https://t.me/PBH\_GE2PLN",
    PESEL: "Как получить песель без мельдунка: https://t.me/PBH\_BY2PLN/83864\n"
           "Успешные кейсы: https://t.me/PBH\_BY2PLN/190620",

    BANKI: "Удаленно открыть счет в польском банке нельзя. Самый простой и самый распространённый вариант среди иностранцев открыть счет только при наличии паспорта и визы - это в отделении банка PKO Bank Polski. Также есть возможность открыть счёт дистанционно в банке Revolut (Литва) через их мобильное приложение.",

    DECLARATION: "Если вы вывозите из РБ дорогостоящие вещи, и планируете ввозить их назад, то имеет смысл их задекларировать при выезде из РБ. \n"
                 "Животных надо декларировать обязательно. \n"
                 "Пример таможенной декларации: https://t.me/PBH\_BY2PLN/57997?single \n"
                 "Каждый человек (включая детей) имеет право перевозить наличные деньги. Денежные средства от 10.000 USD необходимо декларировать (и ехать на красный канал). При сумме от 100.000 USD необходимо показывать происхождение.\n"
                 "Польские таможенники не особо смотрят на личные б/y вещи, поэтому не стоит переживать о том, что вы переезжаете с доверху набитым вещами автомобилем. "
                 "Пару личных ноутов и телевизор можно вывезти и ввести без проблем \n",

    TOURISM:"Польская виза D23 PBH позволяет вам находится 90 дней в полгода в странах Шенгенской зоны в туристических целях (в том числе тех, куда разрешен въезд с визой, выданной страной Шенгена: на Кипр, в Черногорию и т.п.; за исключением Ирландии). \n"
            "При въезде в другие страны, обращайте внимание на актуальные ограничения касательно пандемии: https://reopen.europa.eu/pl",

    TRANSIT:"Вы можете ехать в Польшу через любую страну. Первый и последующий въезд может быть в том числе и через любую страну Шенгенской зоны. \n"
            "При въезде в Польшу через другую страну Шенгенской зоны польские правила карантина на вас не распространяются, однако обращайте внимание на правила транзита через данную страну. В случае вьезда через Литву надо заполнить литовскую форму.\n"
            "В случае путешествия через Россию требуется ПЦР тест для въезда в Россию. Ограничений на выезд из России воздушным или наземным транспортом нет.",

    ANIMALS:"Больше информации в чате про перевозку животных https://t.me/petsToPoland",

    HOUSE:"Подробная информация по поиску и аренде жилья в Польше https://t.me/PBH\_BY2PLN/189343",

    APOSTIL:"Польша принимает белорусские документы без апостиля\n"
            "В других странах ЕС (и не только) - апостиль может понадобиться\n"
            "Но апостиль может понадобится вам в Польше, если вы мед. работник"
            "Перевод белорусских документов в Беларуси делать не нужно, их не примут! Все необходимые переводы вы сделаете в Польше у присяжного переводчика."
}

stemer = Stemmer('russian')
map = [
    ("pesel", "песель"),
    ("pbh", "пбх"),
    ("business", "пбх"),
    ("Blue", "голубая"),
    ("card", "карта"),
    ("d23","д23"),
    ("twoj startup","твой стартап"),
    ("moja firma", "моя фирма"),

]
STOP_WORD=[x[0] for x in
[('на', 1756), ('кто', 956), ('не', 908), ('то', 866), ('ли', 834), ('по', 826), ('подскажите', 820),
 ('или', 804), ('что', 752), ('если', 714),  ('есть', 642), ('как', 596), ('может', 560),
 ('для', 486),  ('добрый', 442), ('из', 440), ('привет', 422), ('пожалуйста', 410),
 ('день', 386), ('это', 308),  ('нибудь', 268), ('вопрос', 266),
 ('но', 260),
 ('здравствуйте', 82), ('бы', 78),('правильно', 76), ('потом', 76),
 ('было', 76), ('мне', 76),('вообще', 74),
('за', 246), ('где', 228), ('только', 226), ('так', 220), ('при', 214), ('надо', 214),
 ('какие', 210), ('уже', 188), ('нет', 188), ('же', 180), ('без', 180),
 ('сейчас', 180), ('будет', 180), ('там', 174), ('все', 170), ('от', 160),
 ('кого', 156), ('до', 150), ('знает', 130), ('быть', 126), ('чтобы', 122),
 ('меня', 118), ('спасибо', 118), ('ещё', 116), ('после', 114), ('какой', 112),
 ('просто', 110), ('еще', 110), ('такой', 108), ('про', 106),  ('вечер', 102),
 ('тут', 96), ('ребята', 96),  ('со', 94), ('дней', 92),
 ('могу', 92), ('тоже', 84), ('понимаю', 74), ('подскажет', 74),  ('вы', 70),
 ('сразу', 70),   ('его', 68),
 ('сегодня', 66), ('ребят', 66), ('скажите', 66),
]]
analyzer = CountVectorizer(stop_words=[]

                           ).build_analyzer()


all22=[]
def stemmed_words(doc):
    global all22
    doc = doc.lower()
    for f, t in map:
        doc = doc.replace(f, t)
 #   doc = re.sub(r'[A-Za-z0-9]+', '', doc)
    doc = doc.rstrip()
    all22+=[w for w in analyzer(doc)]

   # rsp = (stemer.stemWord(w) for w in analyzer(doc))
    #  print(doc,list(rsp))
    return (stemer.stemWord(w) for w in analyzer(doc))
